import{createClient as n,createRequest as t}from"@urql/core";export*from"@urql/core";import{createContext as r,useContext as e,useRef as o,useState as u,useCallback as i,useEffect as c,useMemo as a}from"react";import{toPromise as f,makeSubject as s,concat as l,map as v,fromValue as p,subscribe as d,takeWhile as x,filter as h,share as y,onPush as g,scan as b,switchMap as m}from"wonka";var q=r(n({url:"/graphql"})),w=q.Provider,k=q.Consumer,P=function(){return e(q)};function j(){return(j=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n}).apply(this,arguments)}var I={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0,operation:void 0};function M(n){var r=o(!0),e=P(),a=u(I),s=a[0],l=a[1];function v(n){return r.current&&l({fetching:!1,stale:!!n.stale,data:n.data,error:n.error,extensions:n.extensions,operation:n.operation}),n}var p=i((function(r,o){return l(j({},I,{fetching:!0})),f(e.executeMutation(t(n,r),o||{})).then(v)}),[e,n,l]);function d(){r.current=!1}return c((function(){return d}),[]),[s,p]}var O=!1;function Q(){return O}function S(n,t){function r(){return n}var e=a((function(){var t=s();return[l([v(r)(p(n)),t.source]),function(r){var e=n;try{r!==e&&t.next(n=r)}catch(t){throw n=e,t}}]}),[]),o=e[0],i=e[1],f=u((function(){var n;O=!0;try{d((function(t){n=t}))(x(Q)(t(o))).unsubscribe()}finally{O=!1}return n})),h=f[0],y=f[1];function g(n){O||y((function(t){return function(n,t){if("object"!=typeof n||"object"!=typeof t)return n!==t;for(var r in n)if(!(r in t))return!0;for(var e in t)if(n[e]!==t[e])return!0;return!1}(t,n)?n:t}))}return c((function(){return d(g)(t(o,h)).unsubscribe}),[o]),[h,i]}function C(n,r){var e=o(void 0);return a((function(){var o=t(n,r);return void 0!==e.current&&e.current.key===o.key?e.current:(e.current=o,o)}),[n,r])}function z(n){return void 0!==n}var A=function(n,t){return n.suspense&&(!t||!1!==t.suspense)},B=new Map;function D(n,t){return j({},n,t)}function E(n){return{fetching:!1,stale:!!n.stale,data:n.data,error:n.error,operation:n.operation,extensions:n.extensions}}function F(n){return n?l([p({fetching:!0,stale:!1}),v(E)(n),p({fetching:!1,stale:!1})]):p({fetching:!1,stale:!1})}function G(n,t){return b(D,t||I)(m(F)(n))}function H(n){var t=P(),r=C(n.query,n.variables),e=i((function(e){var o=A(t,n.context),u=o?B.get(r.key):void 0;return u||(u=t.executeQuery(r,j({},{requestPolicy:n.requestPolicy,pollInterval:n.pollInterval},n.context,e)),o&&(u=function(n){var t,r,e=y(n);function o(n){r&&void 0===t&&r(n),t=n}function u(n){r=n}return l([h(z)(v((function(){return t}))(p(t))),function(n){if(g(o)(e)(n),void 0===t)throw new Promise(u)}])}(u),"undefined"!=typeof window&&B.set(r.key,u))),u}),[t,r,n.requestPolicy,n.pollInterval,n.context]),o=a((function(){return n.pause?null:e()}),[n.pause,e]),u=S(o,i(G,[])),f=u[0],s=u[1],d=i((function(n){s(e(j({},{suspense:!1},n)))}),[s,e]);return c((function(){B.delete(r.key),A(t,n.context)||s(o)}),[s,t,o,r,n.context]),A(t,n.context)&&s(o),[f,d]}function J(n){return{fetching:!0,stale:!!n.stale,data:n.data,error:n.error,extensions:n.extensions,operation:n.operation}}function K(n){return n?l([p({fetching:!0,stale:!1}),v(J)(n),p({fetching:!1,stale:!1})]):p({fetching:!1})}function L(n,t){var r=P(),e=o(t);e.current=t;var u=C(n.query,n.variables),f=i((function(t){return r.executeSubscription(u,j({},n.context,t))}),[r,u,n.context]),s=a((function(){return n.pause?null:f()}),[n.pause,f]);function l(n,t){var r=e.current;return j({},n,t,{data:void 0!==t.data?"function"==typeof r?r(n.data,t.data):t.data:n.data})}var v=S(s,i((function(n,t){return b(l,t||I)(m(K)(n))}),[])),p=v[0],d=v[1],x=i((function(n){return d(f(n))}),[d,f]);return c((function(){d(s)}),[d,s]),[p,x]}function N(n){var t=M(n.query);return n.children(j({},t[0],{executeMutation:t[1]}))}function R(n){var t=H(n);return n.children(j({},t[0],{executeQuery:t[1]}))}function T(n){var t=L(n,n.handler);return n.children(j({},t[0],{executeSubscription:t[1]}))}export{k as Consumer,q as Context,N as Mutation,w as Provider,R as Query,T as Subscription,P as useClient,M as useMutation,H as useQuery,L as useSubscription};
//# sourceMappingURL=urql.min.es.js.map
